
\exo{Matrices (7pts)}

On revoit dans cette partie certaines fonctions {\'e}crites dans le
projet. On repr{\'e}sente les matrices avec des structures contenant:
\begin{flist}
\item un nombre \cvar{nb\_lig} de lignes ;
\item un nombre \cvar{nb\_col} de colonnes ;
\item un tableau \cvar{coefficients} de lignes, chaque ligne {\'e}tant un
  tableau de valeurs de type \cdouble.
\end{flist}

\question (1pt) Donnez la d{\'e}claration d'une structure \ctype{matrice}
correspondant {\`a} cette d{\'e}finition.
\begin{solution}
  \begin{Ccode}
    \ctab{}\cstruct \ctype{matrice} \lb
    \ctab{}  \cint \cvar{nb\_col} ;
    \ctab{}  \cint \cvar{nb\_lig} ;
    \ctab{}  \cdouble **coefficients ;
    \ctab{}\rb ;    
  \end{Ccode}
\end{solution}


\question (2pts) On veut n'avoir qu'une fonction, appel{\'e}e
\cfun{matrice}, qui cr{\'e}e des matrices en appelant la fonction
\cfun{malloc}. {\'E}crire cette fonction.
\begin{solution}
  $$
  \mbox{matrice}: \cint \times \cint \to \mbox{struct matrice *}
  $$
  \emph{matrice(i,j)} cr{\'e}e une matrice de $i$ lignes et $j$ colonnes.
  \begin{Ccode}
    \ctab{}\cstruct \ctype{matrice} *
\ctab{}\cfun{matrice} ( \cint \cvar{nb\_col} , \cint \cvar{nb\_lig} )
\ctab{}\lb
\ctab{}  \cint \cvar{\cvar{ligne}} ;
\ctab{}  \cstruct \ctype{matrice} * \cvar{\cvar{res}} ;
\ctab{}
\ctab{}  \cvar{\cvar{res}} = (\cstruct \ctype{matrice} *) \cfun{malloc} ( \cfun{sizeof} ( \cstruct \ctype{matrice} ) ) ;
\ctab{}
\ctab{}  \cvar{\cvar{res}} \ensuremath{\rightarrow} \cvar{nb\_col} = \cvar{nb\_col} ;
\ctab{}  \cvar{\cvar{res}} \ensuremath{\rightarrow} \cvar{nb\_lig} = \cvar{nb\_lig} ;
\ctab{}  \cvar{\cvar{res}} \ensuremath{\rightarrow} coefficients = ( \cdouble ** ) \cfun{malloc} ( \cvar{nb\_lig} * \cfun{sizeof} ( \cdouble * ) ) ;
\ctab{}
\ctab{}  \cfor ( \cvar{\cvar{ligne}} = 0 ; \cvar{\cvar{ligne}} < \cvar{nb\_lig} ; \cvar{\cvar{ligne}} ++ )
\ctab{}    \lb
\ctab{}      \cvar{\cvar{res}} \ensuremath{\rightarrow} coefficients[\cvar{\cvar{ligne}}] = ( \cdouble * ) \cfun{malloc} ( \cvar{nb\_col} * \cfun{sizeof} ( \cdouble ) ) ;
\ctab{}    \rb
\ctab{}
\ctab{}  \creturn \cvar{\cvar{res}} ;
\ctab{}\rb
  \end{Ccode}
\end{solution}

\question (2pts) {\'E}crire une fonction qui rend le r{\'e}sultat de
l'addition de deux matrices. V{\'e}rifiez que les matrices en entr{\'e}e 
sont bien d{\'e}finies et que l'addition des deux matrices en entr{\'e}e est
bien d{\'e}finie.

\begin{solution}
  $$
  \mbox{addition}:  \mbox{struct matrice *} \times \mbox{struct matrice *}  \to \mbox{struct matrice *}
  $$
  \emph{addition(a,b)} rend la matrice qui est le r{\'e}sultat de
  l'addition de $a$ et de $b$, ou \cvar{NULL} si $a=\cvar{NULL}$ ou
  $b=\cvar{NULL}$ ou $a$ et $b$ sont de tailles diff{\'e}rentes.
  \begin{Ccode}
\ctab{}\cstruct \ctype{matrice} *
\ctab{}\cfun{addition} ( \cstruct \ctype{matrice} * \cvar{\cvar{a}} , \cstruct \ctype{matrice} * \cvar{\cvar{b}} )
\ctab{}\lb
\ctab{}  \cstruct \ctype{matrice} * \cvar{c} ;
\ctab{}  \cint \cvar{\cvar{i}} , \cvar{\cvar{j}} ;
\ctab{}
\ctab{}  \cif ( ( \cvar{\cvar{a}} == \cvar{\cvar{\cvar{NULL}}} ) || ( \cvar{\cvar{b}} == \cvar{\cvar{\cvar{NULL}}} ) || 
\ctab{}       ( \cvar{\cvar{a}}\ensuremath{\rightarrow}\cvar{nb\_lig} != \cvar{\cvar{b}} \ensuremath{\rightarrow} \cvar{nb\_lig} ) || 
\ctab{}       ( \cvar{\cvar{a}}\ensuremath{\rightarrow}\cvar{nb\_col} != \cvar{\cvar{b}} \ensuremath{\rightarrow} \cvar{nb\_col} ) )
\ctab{}    \creturn \cvar{\cvar{\cvar{NULL}}} ;
\ctab{}
\ctab{}  \cvar{c} = \cfun{matrice} ( \cvar{\cvar{a}}\ensuremath{\rightarrow}\cvar{nb\_lig} , \cvar{\cvar{a}}\ensuremath{\rightarrow}\cvar{nb\_col} ) ;
\ctab{}
\ctab{}  \cfor ( \cvar{\cvar{i}} = 0 ; \cvar{\cvar{i}} < \cvar{\cvar{a}}\ensuremath{\rightarrow}\cvar{nb\_lig} ; \cvar{\cvar{i}}++ )
\ctab{}    \lb
\ctab{}      \cfor (\cvar{\cvar{j}} = 0 ; \cvar{\cvar{j}} < \cvar{\cvar{a}}\ensuremath{\rightarrow}\cvar{nb\_col} ; \cvar{\cvar{j}}++ )
\ctab{}	\lb
\ctab{}	  \cvar{c}[\cvar{\cvar{i}}][\cvar{\cvar{j}}] = \cvar{\cvar{a}}[\cvar{\cvar{i}}][\cvar{\cvar{j}}] + \cvar{\cvar{b}}[\cvar{\cvar{i}}][\cvar{\cvar{j}}] ;
\ctab{}	\rb
\ctab{}    \rb
\ctab{}
\ctab{}  \creturn \cvar{c} ;
\ctab{}\rb
  \end{Ccode}
\end{solution}


\question (2pts) {\'E}crire une fonction qui rend le r{\'e}sultat du
\emph{produit} de deux matrices. V{\'e}rifiez que les matrices en entr{\'e}e
sont bien d{\'e}finies et que la multiplication des deux matrices en
entr{\'e}e est bien d{\'e}finie.

\begin{solution}
  $$
  \mbox{produit}:  \mbox{struct matrice *} \times \mbox{struct matrice *}  \to \mbox{struct matrice *}
  $$
  \emph{produit(a,b)} rend la matrice qui est le r{\'e}sultat du produit
  de $a$ et de $b$, ou \cvar{NULL} si $a=\cvar{NULL}$ ou
  $b=\cvar{NULL}$ ou le nombre de colonnes de $a$ est diff{\'e}rent du
  nombre de lignes de $b$.
  \begin{Ccode}
\ctab{}\cstruct \ctype{matrice} *
\ctab{}\cfun{produit} ( \cstruct \ctype{matrice} * \cvar{\cvar{a}} , \cstruct \ctype{matrice} * \cvar{\cvar{b}} )
\ctab{}\lb
\ctab{}  \cstruct \ctype{matrice} * \cvar{c} ;
\ctab{}  \cint \cvar{\cvar{i}} , \cvar{\cvar{j}}, \cvar{\cvar{k}} ;
\ctab{}
\ctab{}  \cif ( ( \cvar{\cvar{a}} == \cvar{\cvar{\cvar{NULL}}} ) || ( \cvar{\cvar{b}} == \cvar{\cvar{\cvar{NULL}}} ) || 
\ctab{}       ( \cvar{\cvar{a}}\ensuremath{\rightarrow}\cvar{nb\_col} != \cvar{\cvar{b}} \ensuremath{\rightarrow} \cvar{nb\_lig} ) )
\ctab{}    \creturn \cvar{\cvar{\cvar{NULL}}} ;
\ctab{}
\ctab{}  \cvar{c} = \cfun{matrice} ( \cvar{\cvar{a}}\ensuremath{\rightarrow}\cvar{nb\_lig} , \cvar{\cvar{b}}\ensuremath{\rightarrow}\cvar{nb\_col} ) ;
\ctab{}  \cfor ( \cvar{\cvar{i}} = 0 ; \cvar{\cvar{i}} < \cvar{\cvar{a}}\ensuremath{\rightarrow}\cvar{nb\_lig} ; \cvar{\cvar{i}}++ )
\ctab{}    \lb
\ctab{}      \cfor (\cvar{\cvar{j}} = 0 ; \cvar{\cvar{j}} < \cvar{\cvar{a}}\ensuremath{\rightarrow}\cvar{nb\_col} ; \cvar{\cvar{j}}++ )
\ctab{}	\lb
\ctab{}	  \cvar{c}[\cvar{\cvar{i}}][\cvar{\cvar{j}}] = 0 ;
\ctab{}	  \cfor ( \cvar{\cvar{k}} = 0 ; \cvar{\cvar{k}} < \cvar{\cvar{a}}\ensuremath{\rightarrow}\cvar{nb\_col} ; \cvar{\cvar{k}}++)
\ctab{}	    \lb
\ctab{}	      \cvar{c}[\cvar{\cvar{i}}][\cvar{\cvar{j}}] = \cvar{c}[\cvar{\cvar{i}}][\cvar{\cvar{j}}] + \cvar{\cvar{a}}[\cvar{\cvar{i}}][\cvar{\cvar{k}}] * \cvar{\cvar{b}}[\cvar{\cvar{k}}][\cvar{\cvar{j}}] ;
\ctab{}	    \rb
\ctab{}	\rb
\ctab{}    \rb
\ctab{}  \creturn \cvar{c} ;
\ctab{}\rb
  \end{Ccode}
\end{solution}

