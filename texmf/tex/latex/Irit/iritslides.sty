% Copyright 2007 by Till Tantau
%
% This file may be distributed and/or modified
%
% 1. under the LaTeX Project Public License and/or
% 2. under the GNU Public License.
%
% See the file doc/licenses/LICENSE for more details.

\ProvidesPackageRCS $Header: /cvsroot/latex-beamer/latex-beamer/themes/theme/iritslides.sty,v 1.0 2009/02/13 20:48:30 Chevalier Exp $



% Packages indispensables

\RequirePackage{pgf,pgfarrows,pgfnodes,pgfautomata,pgfheaps,pgfshade}
\RequirePackage{amsmath,amssymb}
\RequirePackage[latin1]{inputenc}
\RequirePackage[T1]{fontenc}
\RequirePackage{color}
\RequirePackage{colortbl}
\RequirePackage{comment}
\RequirePackage{xspace}
\RequirePackage{graphicx}
\RequirePackage{array}


% Fontes

\RequirePackage{mathptmx} % By David Pichaureau
\RequirePackage[scaled=.90]{helvet}
\RequirePackage{courier}
\renewcommand{\rmdefault}{phv} % Arial
\renewcommand{\sfdefault}{phv} % Arial

% Couleurs
\setbeamercolor{palette primary}{fg=red!80!black,bg=blue}
\setbeamercolor{palette secondary}{use=palette primary,fg=black,bg=palette primary.fg!25!white}
\setbeamercolor{palette tertiary}{use=palette primary,fg=black,bg=palette primary.fg!30!white}
\setbeamercolor{palette quaternary}{use=palette primary,fg=black,bg=palette primary.fg!35!white}
\setbeamercolor{palette dark}{use=palette primary,bg=palette primary.fg!70!black,fg=white!50!gray}
\setbeamercolor{palette gray}{use=palette primary,fg=palette primary.fg!40!gray}
\setbeamercolor{palette pale}{use=palette primary,fg=palette primary.fg!80!white}

\setbeamercolor{alerted text}{use=palette primary,fg=palette primary.fg}
%\setbeamercolor{block title}{use=palette primary,bg=palette primary.fg!30!white,fill opacity=0.1,text opacity=1}
\def\blocktitleopacity{0.4}
\def\blockbodyopacity{0.2}


\pgfdeclareimage[width=2.74cm]{irit-logo}{irit-logo}
\pgfdeclareimage[width=2cm]{irit-logo-small}{irit-logo}
\pgfdeclareimage[width=0.5\paperwidth]{irit-big-logo}{irit-logo}
\pgfdeclareimage[width=0.92\paperwidth]{irit-very-big-logo}{irit-logo}



% Logo irit


\newbox\irit@frametitlebox
\newbox\irit@logobox
\setbox\irit@logobox=\hbox to 0pt{%
  \pgfpicture
  \pgfpathrectangle{\pgfpointorigin}{\pgfpoint{\paperwidth}{\paperheight}}
  \pgfusepath{use as bounding box}
  \pgftext[right,bottom,at={%
%\pgfpoint{0.95\paperwidth}{-58pt}}
\pgfpoint{1.07\paperwidth}{-58pt}}]{%
\pgfuseimage{irit-big-logo}}
  \endpgfpicture
}

% Entr{\'e}es communes




\AtBeginSection[]{
\begin{frame}
	\frametitle{Pan}
	\tableofcontents[sectionstyle=show/shade,subsectionstyle=hide]
\end{frame}  

\addtocounter{framenumber}{-1}
\begin{frame}
	\frametitle{Outline}
	\tableofcontents[
        sectionstyle=show/shade,
        subsectionstyle=show/shade/hide]
\end{frame}  

\addtocounter{framenumber}{-1}}
\AtBeginSubsection[]{
\begin{frame}
	\frametitle{Outline}
	\tableofcontents[currentsection,currentsubsection]
\end{frame}  
\addtocounter{framenumber}{-1}}




% macros

\newcommand{\set}[1]{\ensuremath{ \lbrace #1 \rbrace }}
\newcommand{\call}[1]{\ensuremath{\mathcal{#1}}\xspace}
\DeclareGraphicsExtensions{.pdf,.png,.jpg}
\let\LaTeXitem\item
\newenvironment{gitemize}{%
\begin{itemize}
\renewcommand\item{%
\temporal<+(1)>{\usebeamercolor[fg]{palette gray}}{\usebeamercolor[fg]{palette primary}}{}%
\LaTeXitem}
}{\end{itemize}}


\def\keep#1{%
\alt<2>{\usebeamercolor[fg]{palette primary} #1}{#1}}
\def\forget#1{
\alt<2>{\usebeamercolor[fg]{palette gray} #1}{#1}}

\def\fullimage#1{
\begingroup
\usebackgroundtemplate{\includegraphics[width=\paperwidth]{#1}}
\begin{frame}
  
\end{frame}
\endgroup
}

\def\iritImportSlide#1#2{%
\pgfdeclareimage[height=10.5cm]{#1}{#2}
}
\def\iritSlide#1{%
\begin{frame}
  \pgfpicture
  \pgfpathrectangle{\pgfpoint{0cm}{0cm}}{\pgfpoint{12.6cm}{9.6cm}}
  \pgfusepath{use as bounding box}
  \pgftext[left,bottom,at={%
\pgfpoint{-1.4cm}{-0.45cm}}]{%
\pgfuseimage{#1}}
  \endpgfpicture
\end{frame}
}



\mode<article>
{
  \RequirePackage{beamerbasearticle}
  \RequirePackage{a4paper}
  \RequirePackage{hyperref}
}

\mode<handout>
{
\selectcolormodel{gray}
\setbeamercolor{canvas}{bg=white}

%\useinnertheme[shaded]{rounded}
% mise en pages

\RequirePackage{pgfpages}
\pgfpagesuselayout{8 on 1}[a4paper,border shrink=0.5mm]
\pgfpageslogicalpageoptions{1}{border
code=\pgfsetlinewidth{1.5bp}\pgfusepath{stroke},
corner width= 4mm}
\pgfpageslogicalpageoptions{2}{border
code=\pgfsetlinewidth{1.5bp}\pgfusepath{stroke},
corner width= 4mm}
\pgfpageslogicalpageoptions{3}{border
code=\pgfsetlinewidth{1.5bp}\pgfusepath{stroke},
corner width= 4mm}
\pgfpageslogicalpageoptions{4}{border
code=\pgfsetlinewidth{1.5bp}\pgfusepath{stroke},
corner width= 4mm}
\pgfpageslogicalpageoptions{5}{border
code=\pgfsetlinewidth{1.5bp}\pgfusepath{stroke},
corner width= 4mm}
\pgfpageslogicalpageoptions{6}{border
code=\pgfsetlinewidth{1.5bp}\pgfusepath{stroke},
corner width= 4mm}
\pgfpageslogicalpageoptions{7}{border
code=\pgfsetlinewidth{1.5bp}\pgfusepath{stroke},
corner width= 4mm}
\pgfpageslogicalpageoptions{8}{border
code=\pgfsetlinewidth{1.5bp}\pgfusepath{stroke},
corner width= 4mm}

\setbeamertemplate{footline}{%
\raisebox{2mm}{\hbox to \paperwidth{\hspace*{3mm}%
\insertauthor,\insertinstitute\hss{}%
\insertshorttitle\hss{}\hss{}%
\insertpagenumber/\insertdocumentendpage%
\hspace*{3mm}}}}

}



\mode<beamer>
{

% Transparence et fond d'Ã©cran
\setbeamertemplate{blocks}[rounded]
\setbeamercolor{block title}{use=palette primary,fg=palette primary.bg,bg=palette primary.fg!30!black}
\setbeamercolor{block body}{use=palette primary,bg=palette primary.fg!30!black}
% Logos
\setbeamercovered{highly dynamic}
\setbeamercolor{canvas}{bg=black}
\pgfdeclareimage[height=96mm,width=128mm]{upsbackground}{fonds_ups_clair}
\setbeamertemplate{canvas}{\pgfuseimage{upsbackground}}




%%%%%%%%%%%%%%%%%%%%%%%%%
% texte
%%%%%%%%%%%%%%%%%%%%%%%%%

\setbeamerfont{title in sidebar}{series=\bfseries}
\setbeamerfont{section in sidebar}{series=\bfseries,size=\tiny,shape=\scshape}
\setbeamerfont{section in sidebar shaded}{series=\scseries,size=\Tiny}
\setbeamerfont{frametitle}{size={\fontsize{20pt}{6pt}}}

% normal text
\setbeamercolor{normal text}{fg=black,bg=black!10!white}

% example text
\setbeamercolor{example text}{use=palette primary,fg=palette primary.bg!20!black}
\setbeamerfont{example text}{shape=\itshape}

% titles

% sidebar
\setbeamercolor*{sidebar}{use=structure,bg=palette primary.fg}
\setbeamercolor*{palette sidebar primary}{use=structure,fg=palette primary.fg!10}
\setbeamercolor*{palette sidebar secondary}{fg=white}
\setbeamercolor*{palette sidebar tertiary}{use=structure,fg=palette primary.fg!50}
\setbeamercolor*{palette sidebar quaternary}{fg=white}
\setbeamercolor*{titlelike}{parent=palette primary,fg=palette primary.bg}

\setbeamercolor*{separation line}{}
\setbeamercolor*{fine separation line}{}



% l'autre option : invisible, cache totalement le texte pas encore
% d{\'e}couvert (ie, n'utilise pas le ``gris{\'e}'').
% geometrie

\beamer@rightmargin=10pt
\beamer@leftmargin=10pt

\newdimen\irit@slidewidth
\irit@slidewidth=\paperwidth
\advance\irit@slidewidth by \Gm@lmargin
\advance\irit@slidewidth by \Gm@rmargin

\newdimen\irit@slideheight
\irit@slideheight=\paperheight


% D{\'e}finition des couleurs
%\xdefinecolor{white}{rgb}{1,1,1}
%\xdefinecolor{blue}{rgb}{0.2,0.2,0.6}

\newcommand{\blue}[1]{{\usebeamercolor[bg]{palette primary} #1}}
\newcommand\hlite[1]{\blue{\emph{#1}}}

% Utilisation des couleurs

\setbeamercolor{palette sidebar primary}{use=normal text,fg=normal text.fg}
\setbeamercolor{palette sidebar secondary}{use=structure,fg=palette primary.fg}
\setbeamercolor{palette sidebar tertiary}{use=normal text,fg=normal text.fg}
\setbeamercolor{palette sidebar quaternary}{use=structure,fg=palette primary.fg}

% title, subtitle

\setbeamercolor{frametitle}{fg=palette primary.fg,bg=}

% sidebar

\setbeamercolor{sidebar shaded}{parent=palette dark}
\setbeamercolor{sidebar current}{parent=palette primary,bg=palette primary.fg,fg=white}

\setbeamercolor{section in sidebar}{parent=sidebar current}
\setbeamercolor{section in sidebar shaded}{parent=sidebar shaded}
\setbeamercolor{subsection in sidebar}{parent=sidebar current}
\setbeamercolor{subsection in sidebar shaded}{parent=sidebar shaded}

% Table of contents


\setbeamercolor{section in toc}{use=palette.primary,fg=palette primary.fg,bg=normal text.bg}
\setbeamercolor{section in toc shaded}{use=palette dark,fg=palette dark.bg,bg=normal text.bg}
\setbeamercolor{subsection in toc}{use=palette.primary,fg=palette primary.fg,bg=normal text.bg}
\setbeamercolor{subsection in toc shaded}{use=palette dark,fg=palette dark.bg,bg=normal text.bg}

\setbeamercolor{title in sidebar}{fg=white}
\setbeamercolor*{separation line}{}
\setbeamercolor*{fine separation line}{}


\usefonttheme[onlylarge]{structuresmallcapsserif}


% fond d'{\'e}cran



% Navbar

\beamer@nav@subsectionstyle{show/show/hide}


% Sidebar

\newdimen\beamer@sidebarwidth
\newdimen\beamer@headheight
\usebeamerfont{frametitle}
\beamer@sidebarwidth=0mm
\beamer@headheight=10pt
\reset@font
\def\beamer@lefttext{right}
\beamer@headheight=10pt
\def\beamer@sidebarside{right}


\def\beamer@sidebarformat#1#2#3{%
  \begin{beamercolorbox}[wd=\beamer@sidebarwidth,leftskip=#1,rightskip=1ex plus1fil,vmode]{#2}
    \vbox{}%
    #3\par%
    \vbox{}%
    \vskip-1.5ex%
  \end{beamercolorbox}
}


\defbeamertemplate*{section in sidebar}{sidebar theme}
{%
  \vbox{%
    \vskip1ex%
    \beamer@sidebarformat{3pt}{section in sidebar}{\insertsectionhead}%
  }%
}

\defbeamertemplate*{section in sidebar shaded}{sidebar theme}
{%
  \vbox{%
    \vskip1ex%
    \beamer@sidebarformat{3pt}{section in sidebar shaded}{\insertsectionhead}%
  }%
}

\defbeamertemplate*{subsection in sidebar}{sidebar theme}
{%
  \beamer@sidebarformat{5pt}{subsection in sidebar}{\insertsubsectionhead}%
}

\defbeamertemplate*{subsection in sidebar shaded}{sidebar theme}
{%
  \beamer@sidebarformat{5pt}{subsection in sidebar shaded}{\insertsubsectionhead}%
}



\defbeamertemplate*{subsubsection in sidebar}{sidebar theme}
{%
  \beamer@sidebarformat{7pt}{subsubsection in sidebar}{\insertsubsubsectionhead}%
}

\defbeamertemplate*{subsubsection in sidebar shaded}{sidebar theme}
{%
  \beamer@sidebarformat{7pt}{subsubsection in sidebar shaded}{\insertsubsubsectionhead}%
}

\setbeamersize{sidebar width \beamer@sidebarside=\beamer@sidebarwidth}
\defbeamertemplate*{sidebar \beamer@sidebarside}{sidebar theme}{}

\def\toto
{
  \beamer@tempdim=\beamer@sidebarwidth%
  \advance\beamer@tempdim by -6pt%
  {\usebeamerfont{title in sidebar}%
    \vskip.5em%
    \hskip3pt%
    \usebeamercolor[fg]{title in sidebar}%
    \insertshorttitle[width=\beamer@tempdim,center,respectlinebreaks]\par%
    \vskip1.25em%
  }%
  {%
    \hskip3pt%
    \usebeamercolor[fg]{author in sidebar}%
    \usebeamerfont{author in sidebar}%
    \insertshortauthor[width=\beamer@tempdim,center,respectlinebreaks]\par%
    \vskip1.25em%
  }%
  \insertverticalnavigation{\beamer@sidebarwidth}%
  \vfill
}

\setbeamersize{text margin left=0.5cm,text margin right=0.2cm}


% Ligne de titre

\defbeamertemplate*{frametitle}{}
{
\begin{tabular}{p{120mm}}
\usebeamercolor[fg]{frametitle}\Large\insertframetitle\\
\usebeamercolor[fg]{framesubtitle}\large\insertframesubtitle\\
\end{tabular}
}


% Transparent de t{\^e}te


\def\irittitle{%
{
\setbeamertemplate{footline}{}
\setbeamertemplate{canvas}{\includegraphics[width=\paperwidth]{fonds_ups_garde}}
\begin{frame}
  \usebeamercolor[fg]{palette primary}
  \begin{pgfpicture}
  \pgfpathrectangle{\pgfpoint{0cm}{0cm}}{\pgfpoint{12.8cm}{9.6cm}}
  \pgfusepath{use as bounding box}
  \pgftext[left,at={\pgfpoint{0mm}{90mm}}]{\Large \inserttitle}
  \pgftext[left,at={\pgfpoint{90mm}{6mm}}]{\pgfuseimage{irit-logo}}
  \pgftext[left,at={\pgfpoint{44mm}{15mm}}]{\large \insertauthor}
  \pgftext[left,at={\pgfpoint{44mm}{10mm}}]{\large \insertinstitute}
  \pgftext[left,at={\pgfpoint{44mm}{5mm}}]{\large \insertdate}
  \end{pgfpicture}
\end{frame}
}

%\begin{frame}
%  \frametitle{Outline}
% \tableofcontents[hidesubsections]
%\end{frame}
}

\let\maketitle=\irittitle


% themes

\useinnertheme{default}
\setbeamertemplate{frametitle}[default][left]
\setbeamertemplate*{navigation symbols}{}


% footline

\setbeamertemplate{footline}{\usebeamercolor[fg]{palette primary}
\raisebox{2mm}{\hspace*{30mm}\hbox{\includegraphics[width=2cm]{irit-logo}}
\hspace*{5mm}
\hbox to 65mm{\vbox{%
\hbox{\insertauthor, \insertdate}
\hbox{\insertinstitute}
\hbox{\insertshorttitle}}\hfill}%
\hbox{\insertpagenumber/\insertdocumentendpage}}}

}